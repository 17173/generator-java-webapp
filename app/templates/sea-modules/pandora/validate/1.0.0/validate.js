/*! validate-1.0.0 2014-12-19 17:30:36 */
define("pandora/validate/1.0.0/validate",["$","pandora/widget/1.0.0/widget","pandora/base/1.0.0/base","pandora/class/1.0.0/class","pandora/events/1.0.0/events","./rules","./messages"],function(a,b,c){"use strict";var d=a("$"),e=a("pandora/widget/1.0.0/widget"),f=e.extend({defaults:{classPrefix:"",elements:["select[name]","textarea[name]","input[name]"],attributes:["required","pattern","minlength","maxlength","digits","number","url","min","max","equalto","minto","maxto","async"],rules:a("./rules"),messages:a("./messages"),wrapHook:function(a){var b=a.data("validate-wrap");return b||(b=a.closest(".form-group"),0===b.length&&(b=a.parent()),a.data("validate-wrap",b)),b},helpHook:function(a){var b,c=a.data("validate-help");return c||(b=a.data("validate-wrap"),c=b.find(".help-block"),0===c.length&&(c=d('<span class="help-block"></span>').appendTo(b)),a.data("validate-help",c)),c},errorClass:"has-error",customRules:{},customMessages:{},delegates:function(){var a={submit:function(a){a.isDefaultPrevented()||(a.preventDefault(),this.submit())}},b=this.option("elements").join(","),c=this.option("eventType");return a["keydown "+b]=function(a){this.removeError({elem:d(a.currentTarget)})},a["mousedown "+b]=function(a){this.removeError({elem:d(a.currentTarget)})},c&&(a[c+" "+b]=function(a){this.validateElem(d(a.currentTarget),!1)}),a}},setup:function(){var a=this,b=a.option("attributes"),c=a.option("rules"),e=a.option("messages");d.each(a.option("customRules"),function(a,e){"function"==typeof e&&(-1===d.inArray(a,b)&&b.push(a),c[a]=e)}),d.each(a.option("customMessages"),function(a,b){"string"==typeof b&&(e[a]=b)}),a.pendingCount=0,a.errorElements=d(),a.element.attr({novalidate:"novalidate"})},submit:function(){this.data("submitted")?this.checkValidation():this.validateForm()},validateForm:function(){var a=this;a.errorElements=d(),a.data("submitted",!0),a.$(a.option("elements").join(",")).filter(":enabled").each(function(){a.validateElem(d(this),!0)}),a.checkValidation()},validateElem:function(a,b){var c,e=this,f=!0,g={elem:a,name:a.prop("name"),value:a.val(),form:b};e.removeError(g),d.each(e.option("attributes"),function(b,c){var h=a.attr(c);return void 0!==h&&null!==h&&""!==h?f=e.checkRule(d.extend({rule:c,prop:isNaN(h)?h:+h},g)):void 0}),f!==!1&&((c=e.option(["customRules",g.name].join("/")))&&d.each(c,function(a,b){return f=e.checkRule(d.extend({rule:a,prop:isNaN(b)?b:+b},g))}),f===!0&&e.fire("elemValid",a,b))},checkRule:function(a){var b,c=this.option(["rules",a.rule].join("/"));return c?b=c.call(this,a):"function"==typeof a.prop&&(b=a.prop.call(this,a)),b===!1&&this.addError(a),b},checkValidation:function(){var a=this;a.errorElements.length>0?(a.data("submitted",!1),a.fire("error")&&a.errorElements.eq(0).focus()):a.pendingCount<=0&&(a.data("submitted",!1),a.fire("valid")&&a.element[0].submit())},addError:function(a,b){var c=this,d=a.elem;c.option("wrapHook").call(c,d).addClass(c.option("errorClass")),c.option("helpHook").call(c,d).html(b||c.getMessage(a)),c.errorElements=c.errorElements.add(d),c.fire("elemError",d)},removeError:function(a){var b=this,c=a.elem;b.errorElements=b.errorElements.not(c),b.option("wrapHook")(c).removeClass(b.option("errorClass")),b.option("helpHook")(c).empty()},getMessage:function(a){var b=this.option(["customMessages",a.name,a.rule].join("/"))||this.option(["messages",a.rule].join("/"));return b?b.replace(/\{0\}/g,a.prop):""}});f.addRule=function(a){d.extend(!0,f.prototype.defaults.rules,a)},c.exports=f}),define("pandora/validate/1.0.0/rules",[],{required:function(a){var b=a.elem;return/radio|checkbox/.test(b.prop("type"))?a.name?!!this.$('[name="'+a.name+'"]:checked').length:b.is('input[type="checkbox"]'):/\S/.test(a.value)},pattern:function(a){return new RegExp(a.prop).test(a.value)},minlength:function(a){var b=a.value.length;return b?b>=a.prop:!0},maxlength:function(a){var b=a.value.length;return b?b<=a.prop:!0},min:function(a){return isNaN(a.value)||+a.value>=a.prop},max:function(a){return isNaN(a.value)||+a.value<=a.prop},equalto:function(a){return a.value===this.$('[name="'+a.prop+'"]').val()},minto:function(a){return+a.value>=+this.$('[name="'+a.prop+'"]').val()},maxto:function(a){return+a.value<=+this.$('[name="'+a.prop+'"]').val()},digits:function(a){return!/\D/.test(a.value)},number:function(a){return!isNaN(a.value)},url:function(a){return!/\S/.test(a.value)||/^(https?:)?\/\/([a-z0-9][a-z0-9\-]*(\.[a-z0-9][a-z0-9\-]*)*(\.[a-z]{2,})+)(\/\S*)?$/i.test(a.value)},async:function(a){return this.pendingCount++,a.prop.call(this,function(b,c){this.pendingCount--,b||this.addError(a,c),a.form&&this.checkValidation()},a),"pending"}}),define("pandora/validate/1.0.0/messages",[],{required:"\u6b64\u9879\u5fc5\u586b",pattern:"\u4e0d\u7b26\u5408\u6821\u9a8c\u89c4\u5219\uff0c\u8bf7\u68c0\u67e5",minlength:"\u8bf7\u81f3\u5c11\u8f93\u5165{0}\u4e2a\u5b57\u7b26",maxlength:"\u6700\u591a\u8f93\u5165{0}\u4e2a\u5b57\u7b26",min:"\u4e0d\u80fd\u5c0f\u4e8e{0}",max:"\u4e0d\u80fd\u5927\u4e8e{0}",equalto:"\u4e24\u6b21\u8f93\u5165\u7684\u5185\u5bb9\u4e0d\u4e00\u81f4\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165",minto:"\u4e0d\u80fd\u5c0f\u4e8e{0}",maxto:"\u4e0d\u80fd\u5927\u4e8e{0}",digits:"\u8bf7\u8f93\u5165\u6570\u5b57",number:"\u8bf7\u8f93\u5165\u6570\u5b57",url:"\u8bf7\u8f93\u5165URL\u5730\u5740",async:"\u5f02\u6b65\u6821\u9a8c\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5"});